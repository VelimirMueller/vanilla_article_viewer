<!DOCTYPE html>
<html lang="de">
<head>
  <!-- meta -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Probeaufgabe von Velimir MÃ¼ller</title>

  <!-- styles and fonts -->
  <link rel="stylesheet" type="text/css" href="css/main.css">
</head>
<body>
  <!-- template content -->
  <main role="main">
    <section id="articles">
      <div class="template__container relative">
        <!-- content here -->
        <button 
          id="article-toggle-button" 
          class="btn btn__primary btn__article--display-menu" 
          type="button"
          aria-expanded="false"
          aria-controls="overlay">
            Alle Kategorien
        </button>

        <!-- overlay wrapper -->
        <div 
          id="overlay" 
          class="template__overlay" 
          aria-hidden="true">
          <div class="template__overlay--wrapper">
            <!-- articles content -->
             <div 
              class="template__overlay--content"
              role="region"
              aria-label="Article display and menu">
                <aside 
                  id="article-s-menu" 
                  class="template__overlay--articles-menu"
                  aria-labelledby="article-toggle-button"
                  aria-live="polite">
                  <div 
                    id="article-button-container" 
                    class="full-space grid">
                    <!-- create buttons with event listeners dynamically and render them here -->
                  </div>
                </aside>
                <article 
                  id="displayed-article" 
                  class="template__overlay--article"
                  aria-labelledby="article-headline">
                  <div class="padding-article">
                    <h1 
                      id="article-headline" 
                      class="text__article--article-headline"
                      aria-live="polite">
                      <!-- dynamic article headline content will override placeholder -->
                       placeholder
                    </h1>
                    <p 
                      id="article-paragraph" 
                      class="text__article--article-paragraph"
                      aria-live="polite">
                      <!-- dynamic article paragraph content will override placeholder -->
                       placeholder
                    </p>
                  </div>
                </article>
             </div>
          </div>
        </div>
      </div>

    </section>
  </main>

  <script type="module" defer>
  import { 
    addEventListeners, 
    createArticleButtons, 
    fetchArticles, 
    handleOverlay 
  } from './js/index.js'

  // fetch articles
  const articlesData = await fetchArticles()
  const htmlCollection = document.getElementsByClassName('btn__secondary--article')

  // handle overlay
  const overlayHandler = handleOverlay(false)
  document.getElementById('article-toggle-button').addEventListener('click', async () => {
    await overlayHandler.toggleOverlay('overlay', document.getElementById('article-toggle-button'))
    if (overlayHandler.getState()) {
      // default => set first article of articles
      htmlCollection[0].focus()
    }
  })

  // create buttons and add them to DOM (just one DOM update for all buttons)
  createArticleButtons('article-button-container', articlesData.articles, 'btn btn__secondary btn__secondary--article')
  addEventListeners('btn__secondary--article', articlesData.articles, 'article-headline', 'article-paragraph')
  
  </script>
</body>
</html>
