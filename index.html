<!DOCTYPE html>
<html lang="de">
<head>
  <!-- meta -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Probeaufgabe von Velimir MÃ¼ller</title>

  <!-- styles and fonts -->
  <link rel="stylesheet" type="text/css" href="css/main.css">
</head>
<body>
  <!-- template content -->
  <main role="main">
    <section id="articles">
      <div class="template__container">
        <!-- content here -->
        <button 
          id="article-toggle-button" 
          class="btn btn__article--display-menu" 
          type="button"
          aria-label="Toggle article categories menu"
          aria-pressed="false"
          aria-controls="overlay">
            Alle Kategorien
        </button>
        <!-- overlay wrapper -->
        <div 
          id="overlay" 
          class="template__overlay" 
          aria-hidden="true">
          <div class="template__overlay--wrapper">
            <!-- articles content -->
            <button
              id="article-toggle-button-overlay" 
              type="button"
              aria-controls="overlay"
              aria-pressed="false"
              aria-label="Toggle article categories menu"
              class="btn btn__close font-xl margin-left-auto font-xl-bold margin-bot-sm square-45px">
              <icon aria-hidden="true">&#x274c</icon>
            </button>
             <div 
              class="template__overlay--content"
              role="region"
              aria-label="Article display and menu">
                <aside 
                  id="article-s-menu" 
                  class="template__overlay--articles-menu"
                  aria-labelledby="article-toggle-button">
                  <div 
                    id="article-button-container" 
                    class="full-space grid">
                    <!-- create buttons with event listeners dynamically and render them here -->
                    <!-- 
                      I decided to create the buttons dynamically instead of writing direct markup for them
                      I did not want to sacrifice the developer experience for it since I was pretty sure the 
                      performance will still be good if all the buttons will be created in the memory as fragments 
                      first, and added directly to the DOM after that with only 1 DOM update.
                    -->
                  </div>
                </aside>
                <article 
                  id="displayed-article" 
                  class="template__overlay--article"
                  aria-labelledby="article-headline">
                  <div class="padding-article">
                    <h1 
                      id="article-headline" 
                      class="text__article--article-headline"
                      aria-live="polite">
                      <!-- dynamic article headline content will override placeholder -->
                       HEADLINE-PLACEHOLDER
                    </h1>
                    <p 
                      id="article-paragraph" 
                      class="text__article--article-paragraph"
                      aria-live="polite">
                      <!-- dynamic article paragraph content will override placeholder -->
                       PARAGRAPH-PLACEHOLDER
                    </p>
                  </div>
                </article>
             </div>
          </div>
        </div>
      </div>

    </section>
  </main>

  <!-- 
    Javascript as module to keep the project structure tidy.
    Since the lighthouse performance tests was already at 100%,
    there was no need to further improve the performance by writing 
    all javascript directly in the `index.hmtl` instead of separated
    files.
  -->
  <script type="module" defer>
  import { 
    addArticleButtonEventListeners, 
    createArticleButtons, 
    fetchArticles, 
    handleOverlay 
  } from './js/index.js'

  // fetch articles
  const articlesData = await fetchArticles()
  const htmlCollection = document.getElementsByClassName('btn__secondary--article')

  // initializes handleOverlay
  const overlayHandler = handleOverlay()
  document.getElementById('article-toggle-button').addEventListener('click', async () => {
    await overlayHandler.toggleOverlay('overlay', document.getElementById('article-toggle-button'))
    if (overlayHandler.getState()) {
      // default => set first article of articles
      htmlCollection[0].focus()
    }
  })

  // create buttons and add them to DOM (just one DOM update for all buttons)
  createArticleButtons('article-button-container', articlesData.articles, 'btn btn__secondary btn__secondary--article')
  addArticleButtonEventListeners('btn__secondary--article', articlesData.articles, 'article-headline', 'article-paragraph')
  
  </script>
</body>
</html>
